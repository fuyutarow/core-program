## 1. QAPのトレースがなぜ加算ゲートの出力を記録しなくてもいいのか、理由を説明してください。（ヒント: Linear PCP）

加算制約 w3 + w4 = g2 と乗算制約 g1 × g2 = g4 を考える。

g2を代入すると：
g1 × (w3 + w4) = g4

分配法則により：
g1 × w3 + g1 × w4 = g4

これは線形結合の形なので、Linear PCPで直接表現可能。
よってg2を明示的に記録する必要がない。

---

## 2. 講義で紹介された算術回路とセレクター多項式をもとにマスター多項式p(x)と商多項式q(x)を一つ考えてください。

#### マスター多項式p(x)

簡単な例（F₇, ω=2）：
- witness: c = [1, 1, 1, 1, 1, 1, 1, 1, 1]（すべて1）
- ゲート1（x=2）: 1×1=1
- ゲート2（x=4）: 1×1=1
- ゲート3（x=1）: 1×1=1

$$
L(x) = \sum c_i l_i(x) = l_1(x) + l_2(x) + ... + l_9(x)
$$

$$
R(x) = \sum c_i r_i(x) = r_1(x) + r_2(x) + ... + r_9(x)
$$

$$
O(x) = \sum c_i o_i(x) = o_1(x) + o_2(x) + ... + o_9(x)
$$

$$
p(x) = L(x) \cdot R(x) - O(x)
$$

#### 商多項式q(x)

$$
V(x) = (x-2)(x-4)(x-1)
$$

各ゲートで制約が満たされるので：
- p(2) = L(2)R(2) - O(2) = 1×1 - 1 = 0
- p(4) = L(4)R(4) - O(4) = 1×1 - 1 = 0
- p(1) = L(1)R(1) - O(1) = 1×1 - 1 = 0

よって p(x) = V(x)q(x) となる q(x) が存在。

---

## 3. Linear PCPベースのSNARKとGroth16がどのような安全性仮定に基づいているか説明してください。(ヒント: Generic Group Model, KoE Assumption)

**1. Generic Group Model (GGM):**
群要素 g^a から a を求める離散対数問題が困難という仮定。
攻撃者は群演算とペアリングのみ可能で、他の方法で離散対数を解けない。

**2. Knowledge of Exponent (KoE) Assumption:**
(g^a, g^{αa}) のペアを出力できる攻撃者は、指数 a を「知っている」という仮定。

Groth16での適用：
- セットアップで τ を隠す → GGMにより τ を復元不可能
- 証明 π = g^{f(τ)} を作れる → KoEにより f(x) の係数を知っている
- よって正しいwitnessなしに有効な証明を作ることは困難